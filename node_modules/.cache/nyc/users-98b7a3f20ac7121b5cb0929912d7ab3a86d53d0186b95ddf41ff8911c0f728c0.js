function cov_c97gbz1ay(){var path="/home/leonardo/Projects/sd-011-cookmaster/src/controllers/users.js";var hash="5e462f775d75c6d5fb13e927e9d0c7844ae52635";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/leonardo/Projects/sd-011-cookmaster/src/controllers/users.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:49}},"1":{start:{line:3,column:19},end:{line:15,column:1}},"2":{start:{line:4,column:36},end:{line:4,column:44}},"3":{start:{line:6,column:22},end:{line:6,column:70}},"4":{start:{line:8,column:2},end:{line:10,column:3}},"5":{start:{line:9,column:4},end:{line:9,column:78}},"6":{start:{line:12,column:18},end:{line:12,column:70}},"7":{start:{line:14,column:2},end:{line:14,column:32}},"8":{start:{line:17,column:20},end:{line:36,column:1}},"9":{start:{line:18,column:36},end:{line:18,column:44}},"10":{start:{line:19,column:19},end:{line:19,column:27}},"11":{start:{line:21,column:22},end:{line:21,column:48}},"12":{start:{line:23,column:2},end:{line:25,column:3}},"13":{start:{line:24,column:4},end:{line:24,column:86}},"14":{start:{line:27,column:22},end:{line:27,column:70}},"15":{start:{line:29,column:2},end:{line:31,column:3}},"16":{start:{line:30,column:4},end:{line:30,column:78}},"17":{start:{line:33,column:19},end:{line:33,column:72}},"18":{start:{line:35,column:2},end:{line:35,column:33}},"19":{start:{line:38,column:0},end:{line:38,column:45}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:19},end:{line:3,column:20}},loc:{start:{line:3,column:45},end:{line:15,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:20},end:{line:17,column:21}},loc:{start:{line:17,column:46},end:{line:36,column:1}},line:17}},branchMap:{"0":{loc:{start:{line:8,column:2},end:{line:10,column:3}},type:"if",locations:[{start:{line:8,column:2},end:{line:10,column:3}},{start:{line:8,column:2},end:{line:10,column:3}}],line:8},"1":{loc:{start:{line:23,column:2},end:{line:25,column:3}},type:"if",locations:[{start:{line:23,column:2},end:{line:25,column:3}},{start:{line:23,column:2},end:{line:25,column:3}}],line:23},"2":{loc:{start:{line:29,column:2},end:{line:31,column:3}},type:"if",locations:[{start:{line:29,column:2},end:{line:31,column:3}},{start:{line:29,column:2},end:{line:31,column:3}}],line:29}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5e462f775d75c6d5fb13e927e9d0c7844ae52635"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_c97gbz1ay=function(){return actualCoverage;};}return actualCoverage;}cov_c97gbz1ay();const usersService=(cov_c97gbz1ay().s[0]++,require('../services/users'));cov_c97gbz1ay().s[1]++;const createUser=async(req,res,next)=>{cov_c97gbz1ay().f[0]++;const{name,email,password}=(cov_c97gbz1ay().s[2]++,req.body);const emailExists=(cov_c97gbz1ay().s[3]++,await usersService.emailAlreadyRegistered(email));cov_c97gbz1ay().s[4]++;if(emailExists){cov_c97gbz1ay().b[0][0]++;cov_c97gbz1ay().s[5]++;return next({code:'emailExists',message:'Email already registered'});}else{cov_c97gbz1ay().b[0][1]++;}const newUser=(cov_c97gbz1ay().s[6]++,await usersService.createUser(name,email,password));cov_c97gbz1ay().s[7]++;res.status(201).json(newUser);};cov_c97gbz1ay().s[8]++;const createAdmin=async(req,res,next)=>{cov_c97gbz1ay().f[1]++;const{name,email,password}=(cov_c97gbz1ay().s[9]++,req.body);const{role}=(cov_c97gbz1ay().s[10]++,req.user);const isRoleAdmin=(cov_c97gbz1ay().s[11]++,usersService.isAdmin(role));cov_c97gbz1ay().s[12]++;if(!isRoleAdmin){cov_c97gbz1ay().b[1][0]++;cov_c97gbz1ay().s[13]++;return next({code:'notAdmin',message:'Only admins can register new admins'});}else{cov_c97gbz1ay().b[1][1]++;}const emailExists=(cov_c97gbz1ay().s[14]++,await usersService.emailAlreadyRegistered(email));cov_c97gbz1ay().s[15]++;if(emailExists){cov_c97gbz1ay().b[2][0]++;cov_c97gbz1ay().s[16]++;return next({code:'emailExists',message:'Email already registered'});}else{cov_c97gbz1ay().b[2][1]++;}const newAdmin=(cov_c97gbz1ay().s[17]++,await usersService.createAdmin(name,email,password));cov_c97gbz1ay().s[18]++;res.status(201).json(newAdmin);};cov_c97gbz1ay().s[19]++;module.exports={createUser,createAdmin};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJzLmpzIl0sIm5hbWVzIjpbInVzZXJzU2VydmljZSIsInJlcXVpcmUiLCJjcmVhdGVVc2VyIiwicmVxIiwicmVzIiwibmV4dCIsIm5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiYm9keSIsImVtYWlsRXhpc3RzIiwiZW1haWxBbHJlYWR5UmVnaXN0ZXJlZCIsImNvZGUiLCJtZXNzYWdlIiwibmV3VXNlciIsInN0YXR1cyIsImpzb24iLCJjcmVhdGVBZG1pbiIsInJvbGUiLCJ1c2VyIiwiaXNSb2xlQWRtaW4iLCJpc0FkbWluIiwibmV3QWRtaW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoibXNGQWVZO3lGQWZaLEtBQU1BLENBQUFBLFlBQVkseUJBQUdDLE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQWxCLEMsdUJBRUEsS0FBTUMsQ0FBQUEsVUFBVSxDQUFHLE1BQU9DLEdBQVAsQ0FBWUMsR0FBWixDQUFpQkMsSUFBakIsR0FBMEIsd0JBQzNDLEtBQU0sQ0FBRUMsSUFBRixDQUFRQyxLQUFSLENBQWVDLFFBQWYsMEJBQTRCTCxHQUFHLENBQUNNLElBQWhDLENBQU4sQ0FFQSxLQUFNQyxDQUFBQSxXQUFXLHlCQUFHLEtBQU1WLENBQUFBLFlBQVksQ0FBQ1csc0JBQWIsQ0FBb0NKLEtBQXBDLENBQVQsQ0FBakIsQ0FIMkMsdUJBSzNDLEdBQUlHLFdBQUosQ0FBaUIsa0RBQ2YsTUFBT0wsQ0FBQUEsSUFBSSxDQUFDLENBQUVPLElBQUksQ0FBRSxhQUFSLENBQXVCQyxPQUFPLENBQUUsMEJBQWhDLENBQUQsQ0FBWCxDQUNELENBRkQsZ0NBSUEsS0FBTUMsQ0FBQUEsT0FBTyx5QkFBRyxLQUFNZCxDQUFBQSxZQUFZLENBQUNFLFVBQWIsQ0FBd0JJLElBQXhCLENBQThCQyxLQUE5QixDQUFxQ0MsUUFBckMsQ0FBVCxDQUFiLENBVDJDLHVCQVczQ0osR0FBRyxDQUFDVyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJGLE9BQXJCLEVBQ0QsQ0FaRCxDLHVCQWNBLEtBQU1HLENBQUFBLFdBQVcsQ0FBRyxNQUFPZCxHQUFQLENBQVlDLEdBQVosQ0FBaUJDLElBQWpCLEdBQTBCLHdCQUM1QyxLQUFNLENBQUVDLElBQUYsQ0FBUUMsS0FBUixDQUFlQyxRQUFmLDBCQUE0QkwsR0FBRyxDQUFDTSxJQUFoQyxDQUFOLENBQ0EsS0FBTSxDQUFFUyxJQUFGLDJCQUFXZixHQUFHLENBQUNnQixJQUFmLENBQU4sQ0FFQSxLQUFNQyxDQUFBQSxXQUFXLDBCQUFHcEIsWUFBWSxDQUFDcUIsT0FBYixDQUFxQkgsSUFBckIsQ0FBSCxDQUFqQixDQUo0Qyx3QkFNNUMsR0FBSSxDQUFDRSxXQUFMLENBQWtCLG1EQUNoQixNQUFPZixDQUFBQSxJQUFJLENBQUMsQ0FBRU8sSUFBSSxDQUFFLFVBQVIsQ0FBb0JDLE9BQU8sQ0FBRSxxQ0FBN0IsQ0FBRCxDQUFYLENBQ0QsQ0FGRCxnQ0FJQSxLQUFNSCxDQUFBQSxXQUFXLDBCQUFHLEtBQU1WLENBQUFBLFlBQVksQ0FBQ1csc0JBQWIsQ0FBb0NKLEtBQXBDLENBQVQsQ0FBakIsQ0FWNEMsd0JBWTVDLEdBQUlHLFdBQUosQ0FBaUIsbURBQ2YsTUFBT0wsQ0FBQUEsSUFBSSxDQUFDLENBQUVPLElBQUksQ0FBRSxhQUFSLENBQXVCQyxPQUFPLENBQUUsMEJBQWhDLENBQUQsQ0FBWCxDQUNELENBRkQsZ0NBSUEsS0FBTVMsQ0FBQUEsUUFBUSwwQkFBRyxLQUFNdEIsQ0FBQUEsWUFBWSxDQUFDaUIsV0FBYixDQUF5QlgsSUFBekIsQ0FBK0JDLEtBQS9CLENBQXNDQyxRQUF0QyxDQUFULENBQWQsQ0FoQjRDLHdCQWtCNUNKLEdBQUcsQ0FBQ1csTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCTSxRQUFyQixFQUNELENBbkJELEMsd0JBcUJBQyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FBRXRCLFVBQUYsQ0FBY2UsV0FBZCxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHVzZXJzU2VydmljZSA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL3VzZXJzJyk7XG5cbmNvbnN0IGNyZWF0ZVVzZXIgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc3QgeyBuYW1lLCBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuXG4gIGNvbnN0IGVtYWlsRXhpc3RzID0gYXdhaXQgdXNlcnNTZXJ2aWNlLmVtYWlsQWxyZWFkeVJlZ2lzdGVyZWQoZW1haWwpO1xuXG4gIGlmIChlbWFpbEV4aXN0cykge1xuICAgIHJldHVybiBuZXh0KHsgY29kZTogJ2VtYWlsRXhpc3RzJywgbWVzc2FnZTogJ0VtYWlsIGFscmVhZHkgcmVnaXN0ZXJlZCcgfSk7XG4gIH1cblxuICBjb25zdCBuZXdVc2VyID0gYXdhaXQgdXNlcnNTZXJ2aWNlLmNyZWF0ZVVzZXIobmFtZSwgZW1haWwsIHBhc3N3b3JkKTtcblxuICByZXMuc3RhdHVzKDIwMSkuanNvbihuZXdVc2VyKTtcbn07XG5cbmNvbnN0IGNyZWF0ZUFkbWluID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgbmFtZSwgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcbiAgY29uc3QgeyByb2xlIH0gPSByZXEudXNlcjtcblxuICBjb25zdCBpc1JvbGVBZG1pbiA9IHVzZXJzU2VydmljZS5pc0FkbWluKHJvbGUpOyBcblxuICBpZiAoIWlzUm9sZUFkbWluKSB7XG4gICAgcmV0dXJuIG5leHQoeyBjb2RlOiAnbm90QWRtaW4nLCBtZXNzYWdlOiAnT25seSBhZG1pbnMgY2FuIHJlZ2lzdGVyIG5ldyBhZG1pbnMnIH0pO1xuICB9XG4gIFxuICBjb25zdCBlbWFpbEV4aXN0cyA9IGF3YWl0IHVzZXJzU2VydmljZS5lbWFpbEFscmVhZHlSZWdpc3RlcmVkKGVtYWlsKTtcblxuICBpZiAoZW1haWxFeGlzdHMpIHtcbiAgICByZXR1cm4gbmV4dCh7IGNvZGU6ICdlbWFpbEV4aXN0cycsIG1lc3NhZ2U6ICdFbWFpbCBhbHJlYWR5IHJlZ2lzdGVyZWQnIH0pO1xuICB9XG5cbiAgY29uc3QgbmV3QWRtaW4gPSBhd2FpdCB1c2Vyc1NlcnZpY2UuY3JlYXRlQWRtaW4obmFtZSwgZW1haWwsIHBhc3N3b3JkKTtcblxuICByZXMuc3RhdHVzKDIwMSkuanNvbihuZXdBZG1pbik7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgY3JlYXRlVXNlciwgY3JlYXRlQWRtaW4gfTtcbiJdfQ==